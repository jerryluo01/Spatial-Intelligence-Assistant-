services:
    qdrant:
        image: qdrant/qdrant:v1.9.2
        ports:
            - "6333:6333"
        volumes:
            - qdrant_storage:/qdrant/storage

    ollama:
        image: ollama/ollama:latest
        ports:
            - "11434:11434"
        volumes:
            - ollama_models:/root/.ollama
        command: serve

    backend:
        build: .
        depends_on:
            - qdrant
            - ollama
        environment:
            - QDRANT_URL=http://qdrant:6333
            - OLLAMA_URL=http://ollama:11434
            - OLLAMA_MODEL=mistral
            - QDRANT_COLLECTION=solar_orbiter
            - EMBED_MODEL_NAME=sentence-transformers/all-MiniLM-L6-v2
            - VECTOR_SIZE=384
        ports:
            - "8000:8000"

volumes:
    qdrant_storage:
    ollama_models:
